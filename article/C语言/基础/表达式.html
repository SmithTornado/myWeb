<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>C语言表达式</title>
    <link rel="stylesheet" href="../../../highlight/styles/arta.min.css">
    <link rel="stylesheet" href="../../../css/article-common.css">
</head>
<body>
    <h1>C语言表达式</h1>
    <p>表达式是C语言中数据运算与逻辑处理的核心语法结构，由操作数（变量、常量、函数返回值等）和运算符按规则组合而成，**每个表达式必然对应一个唯一结果值**，可直接参与计算、赋值或条件判断。表达式的运算结果由运算符优先级、结合性及操作数类型共同决定，以下是各类核心表达式的用法与细节。</p>

    <h2>一、表达式核心规则</h2>
    <p>所有表达式运算均遵循统一基础规则，是避免运算结果异常的关键：</p>
    <ul>
        <li>优先级：多运算符共存时，按优先级高低执行（如<code>*、/</code>高于<code>+、-</code>），优先级相同则按结合性执行。</li>
        <li>结合性：左结合（从左到右运算，如算术、赋值表达式）、右结合（从右到左运算，如连续赋值、单目运算符）。</li>
        <li>结果类型：运算后会自动进行类型转换（低精度转高精度），最终结果有明确数据类型（如整型、布尔值）。</li>
    </ul>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    // 优先级：*高于+，结果=2+12=14
    int res1 = 2 + 3 * 4;
    // 结合性：连续赋值右结合，先a=5，再b=a=5
    int a, b = (a = 5);
    printf("优先级示例：%d\n", res1);
    printf("结合性示例：a=%d, b=%d\n", a, b);
    return 0;
}</code></pre>

    <h2>二、常用表达式分类及用法</h2>

    <h3>1. 常量表达式</h3>
    <p>仅由常量或字面量组成，无变量参与，值固定不变，常用于变量初始化、数组长度定义等场景。</p>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    // 整型常量表达式
    int num1 = 10 + 5 * 2;
    // 浮点型常量表达式
    float num2 = 3.14 * 2;
    // 字符型常量表达式
    char ch = 'A' + 32; // 'A'的ASCII码+32=小写'a'
    // 常量表达式作为数组长度（C99及以上支持变量，传统C仅支持常量）
    int arr[5 + 3] = {1,2,3,4,5,6,7,8};

    printf("num1=%d, num2=%.2f, ch=%c\n", num1, num2, ch);
    return 0;
}</code></pre>

    <h3>2. 算术表达式</h3>
    <p>由算术运算符（<code>+、-、*、/、%、++、--</code>）组合而成，用于数值计算，结果为对应数值类型。</p>
    <p>关键注意：整数除法取整、取余仅支持整数、自增自减有前置/后置差异。</p>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    int a = 8, b = 3;
    int add = a + b;    // 加法：11
    int sub = a - b;    // 减法：5
    int mul = a * b;    // 乘法：24
    int div = a / b;    // 整数除法：2（取整）
    int mod = a % b;    // 取余：2
    int inc = ++a;      // 前置自增：9（先增后用）

    printf("加法：%d, 减法：%d\n", add, sub);
    printf("乘法：%d, 整数除法：%d\n", mul, div);
    printf("取余：%d, 前置自增：%d\n", mod, inc);
    return 0;
}</code></pre>

    <h3>3. 赋值表达式</h3>
    <p>由赋值运算符（<code>=、+=、-=、*=</code>等）组合而成，核心功能是给变量赋值，**表达式结果为赋值后左变量的值**。</p>
    <p>支持连续赋值，按右结合性执行，复合赋值可简化代码（如<code>a += b</code>等价于<code>a = a + b</code>）。</p>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    int a = 10;
    // 基本赋值：表达式结果=15，同时a=15
    int res = (a = 15);
    // 复合赋值：a=15+5=20
    a += 5;
    // 连续赋值：先c=25，再b=c=25，最后a=b=25
    int b, c;
    a = b = c = 25;

    printf("赋值表达式结果：%d\n", res);
    printf("复合赋值后a=%d\n", a);
    printf("连续赋值后：a=%d, b=%d, c=%d\n", a, b, c);
    return 0;
}</code></pre>

    <h3>4. 关系表达式</h3>
    <p>由关系运算符（<code>==、!=、>、<、>=、<=</code>）组合而成，用于比较两个值的大小关系，**结果为布尔值（1表示真，0表示假）**。</p>
    <p>注意：不可连续写多重比较（如<code>3 &lt; a &lt; 5</code>），需用逻辑运算符拼接。</p>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    int a = 6, b = 4;
    // 结果1（真）：6>4成立
    int res1 = a > b;
    // 结果0（假）：6==4不成立
    int res2 = a == b;
    // 结果1（真）：6>=4成立
    int res3 = a >= b;
    // 错误写法：3<a<5 等价 (3<a)<5 → 1<5=1，逻辑错误
    // 正确写法：用&&拼接
    int res4 = a > 3 && a < 5; // 结果0（假）

    printf("res1=%d, res2=%d, res3=%d, res4=%d\n", res1, res2, res3, res4);
    return 0;
}</code></pre>

    <h3>5. 逻辑表达式</h3>
    <p>由逻辑运算符（<code>&&、||、!</code>）组合而成，用于逻辑判断，操作数为布尔值（非0即真、0即假），**结果为1（真）或0（假）**。</p>
    <p>核心特性：存在短路运算（<code>&&</code>左假则右不执行，<code>||</code>左真则右不执行）。</p>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    int x = 1, y = 0, z = 5;
    // 逻辑与：左真执行右，z=6，结果1
    int res1 = x && (z++);
    // 逻辑或：左假执行右，z=7，结果1
    int res2 = y || (z++);
    // 逻辑非：真变假，结果0
    int res3 = !x;

    printf("res1=%d, res2=%d, res3=%d\n", res1, res2, res3);
    printf("短路运算后z=%d\n", z); // 最终z=7
    return 0;
}</code></pre>

    <h3>6. 位表达式</h3>
    <p>由位运算符（<code>&、|、^、~、<<、>>></code>）组合而成，直接操作整数的二进制位，结果为整型。</p>
    <p>常用场景：位级运算、权限控制、数值快速计算（左移乘2、右移除2）。</p>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    int a = 5;  // 二进制：00000101
    int b = 3;  // 二进制：00000011
    int and = a & b;   // 按位与：00000001 → 1
    int or = a | b;    // 按位或：00000111 → 7
    int xor = a ^ b;   // 按位异或：00000110 → 6
    int not = ~a;      // 按位取反：11111010 → -6
    int left = a << 1; // 左移1位：00001010 → 10（5×2）
    int right = a >> 1;// 右移1位：00000010 → 2（5÷2取整）

    printf("按位与：%d, 按位或：%d\n", and, or);
    printf("按位异或：%d, 按位取反：%d\n", xor, not);
    printf("左移：%d, 右移：%d\n", left, right);
    return 0;
}</code></pre>

    <h3>7. 条件表达式</h3>
    <p>C语言唯一三目表达式，格式：<code>表达式1 ? 表达式2 : 表达式3</code>，根据表达式1的真假返回对应结果。</p>
    <p>执行逻辑：表达式1为真返回表达式2的值，为假返回表达式3的值，可简化条件判断代码。</p>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    int a = 12, b = 18;
    // 求最大值：a<b为真，返回b=18
    int max = a < b ? b : a;
    // 求最小值：a<b为真，返回a=12
    int min = a < b ? a : b;
    // 判断奇偶性：12%2=0为真，返回"偶数"
    char* flag = a % 2 == 0 ? "偶数" : "奇数";

    printf("最大值：%d, 最小值：%d\n", max, min);
    printf("%d是%s\n", a, flag);
    return 0;
}</code></pre>

    <h3>8. 逗号表达式</h3>
    <p>由逗号运算符（<code>,</code>）连接多个表达式，按**从左到右依次执行**，**最终结果为最右侧表达式的值**。</p>
    <p>优先级最低，常用于一行执行多个简单操作（如变量初始化、循环条件）。</p>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    int x, y, res;
    // 从左到右执行：x=3→y=5→res=3+5=8，逗号表达式结果=8
    res = (x=3, y=5, x+y);
    // 循环中使用：初始化i=0、j=10，循环条件i<5，循环后i++
    for (int i=0, j=10; i<5; (i++, j--)) {
        printf("i=%d, j=%d\n", i, j);
    }

    printf("逗号表达式结果：%d\n", res);
    return 0;
}</code></pre>

    <h3>9. 函数表达式</h3>
    <p>将函数调用作为操作数参与表达式运算，要求函数有返回值，表达式结果为函数的返回值。</p>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
// 定义有返回值的函数（求两数之和）
int add(int m, int n) {
    return m + n;
}

int main() {
    // 函数表达式：add(4,6)返回10，参与加法运算，结果=20
    int total = add(4, 6) * 2;
    // 函数表达式直接赋值
    int sum = add(10, 20);

    printf("sum=%d, total=%d\n", sum, total);
    return 0;
}</code></pre>

    <h2>三、表达式常见问题与注意事项</h2>
    <ul>
        <li>优先级混淆：复杂表达式建议用括号明确运算顺序，避免结果错误（如<code>(a+b)*c</code>而非<code>a+b*c</code>）。</li>
        <li>短路运算陷阱：逻辑表达式中，短路部分的代码不会执行，避免在短路部分写变量修改操作。</li>
        <li>数据溢出：算术表达式计算时，结果超出变量类型取值范围会溢出（如int最大值+1会变成最小值）。</li>
        <li>连续比较错误：多重范围比较需用逻辑运算符拼接，不可直接连续写关系运算符。</li>
    </ul>
    <pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
    // 错误：短路运算中z++不执行，z仍为5
    int x=0, z=5;
    x && (z++);
    // 错误：连续比较等价(3<6)<8=1<8=1，逻辑错误
    int a=6, res=3<a<8;
    // 正确：用&&拼接
    int correct_res = a>3 && a<8;

    printf("短路陷阱：z=%d\n", z);
    printf("连续比较错误结果：%d，正确结果：%d\n", res, correct_res);
    return 0;
}</code></pre>
</body>
    <script type="text/javascript" src="../../../highlight/highlight.min.js"></script>
    <script type="text/javascript" src="../../../js/article-common.js"></script>
    <script type="text/javascript">hljs.highlightAll();</script>
    <script>
        addCopy('pre', 20, 20)            
    </script>
</html>